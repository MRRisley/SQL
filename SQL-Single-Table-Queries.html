<!DOCTYPE html>

<!--SQL-->

<html lang="en">

<!--HEAD-->
<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125795941-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125795941-1');
</script>
	
	<meta charset="UTF-8">
	<title>MRRisley:=("Simple Queries")</title>
	<meta name="description" content="Single-Table Queries in T-SQL">
	<meta name="author" content="Matt Risley">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="stylesheet" href="../MRRisley/css/normalize.css">
	<link rel="stylesheet" href="../MRRisley/css/skeleton.css">
	<link rel="stylesheet" href="../MRRisley/css/custom.css">
	
		<style>
		* body {
			margin: 0;
			font-family: Courier New, Arial, monotype;
		}
		</style>
</head>

<!--BODY-->
<body>
	
<div class="container" id="top">
	<h3 align="center">MRRisley:=("Single-Table Queries in T-SQL")</h3>
		<h6 align="center">Note: This guide is adapted from Itzik Ben-Gan's <i>T-SQL Fundamentals</i>, 3rd edition.</h6>
	<div align="center"><a href="https://github.com/MRRisley/SQL"><img src="../MRRisley/images/github_mark.png" alt="Github Icon with Link"></a></div>
	<h5 align="center"><a href = "../SQL/index.html">Back to SQL Home</a></h5>


<div class="container" id="nav">
	<h5>Topics</h5>
	<p><a href = "#intro">1. Intro to Single-Table Queries</a>
	<!--<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#intro_a">a. Types of Programming</a>-->
	
	<br><a href = "#select">2. The <code>SELECT</code> statement</a>
	
	<br><a href = "#from">3. The <code>FROM</code> clause</a>
	
	
	
	<br><a href = "#clauses">4. Clauses</a>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#where-clause">a. <code>WHERE</code> clause</a>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#group-by-clause">b. <code>GROUP BY</code> clause</a>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#having-clause">c. <code>HAVING</code> clause</a>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#order-by-clause">d. <code>ORDER BY</code> clause</a>
	
	<br><a href = "#clauses">5. Operators</a>
	
	<br><a href = "#clauses">6. <code>CASE</code> expressions</a>
	
	<br><a href = "#operators">7. Data Types</a>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#null">a. <code>NULL</code></a>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#characters">b. Character Data</a>
	<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href = "#dates">c. Dates</a>
	</p>
</div>
	
<div class="docs-section" id="intro">
  <h5 class="title">1. Intro to Single-Table Queries</h5>
	<p>Data within relational databases are stored in tables as observations, or <b>records</b>. Each record has one or more <b>fields</b>, or columns.
	If you're familiar with Excel Pivot tables, relational data are essentially the original, un-pivoted data.
	The table excerpt below demonstrates the structure of tables within relational databases.</p>
	
	
	
	<pre>
DepartmentID	Name		GroupName			ModifiedDate
1		Engineering	Research and Development	2008-04-30 00:00:00.000
2		Tool Design	Research and Development	2008-04-30 00:00:00.000
3		Sales		Sales and Marketing		2008-04-30 00:00:00.000
4		Marketing	Sales and Marketing		2008-04-30 00:00:00.000
5		Purchasing	Inventory Management		2008-04-30 00:00:00.000

...
	</pre>
	
	
	
	Single-table queries are the foundation of SQL. A single-table query is simply what it says: a query on a single table. A query is (usually) a small program
	that specifies what to return from a table. Queries can "filter" results, they can aggregate results, and they can sort them. Imagine you work at a bank and have
	a table with checking accounts. You want to return checking accounts that are inactive. A pseudo-query may look like:</p>
	
	<pre><code>
select account#
from checkingaccountdata
where status = 'inactive'
	</code></pre>
	
	<p>The query can be read as follows: <code>select</code> the <code>account#</code> field from the <code>checkingaccountdata</code> table 
	for all records where another field, <code>status</code>, is equal to "inactive". Note that SQL is <b>NOT</b> case sensitive. It does not
	care whether you capitalize or not. This is not true for all programming languages, however.</p>
	
		<div align="center"><a href = "#top"><h6>Top</h6></a></div>
</div>


<div class="docs-section" id="select">
  <h5 class="select">2. The <code>SELECT</code> Statement</h5>
	<p>The <code>SELECT</code> statement is the mother of all statements. The base requirement for a query is the <code>SELECT</code> statement. As shown above,
	this statement essentially tells the server precisely what you want to see. Without it, there is no query.</p>
	<p>Because the <code>SELECT</code> statement is the only required piece of a query, all other components are usually referred to as <b>clauses</b>,
	which are simply qualifiactions to the statement. Telling the statement what table to look at and how to look at it are common clauses--so common, in fact, that
    the distinction between the <code>SELECT</code> statement and the <code>FROM</code> clause is mostly a semantic issue.</p>	
	<p>I have only used the <code>SELECT</code> statement by itself in practice to perform basic operations. Unlike some programming languages, such as R or Excel VBA,
	SQL does not have a "console," which is essentially a command line. In other languages, this is where you could easily and quickly return a result, such as the 
	square root of 898. Without a console, the code must be written within the script:</p>	
	
		<pre><code>
select sqrt(898)
		</code></pre>
	
	<p>Note that these kind of operations in SQL are usually much more difficult to program than simply arriving at the answer using a calculator.
	This is due to a number of reasons, such as T-SQL not supporting complex numbers as well as floating-point precision. For example,</p> 

		<pre><code>
select 50/100
		</code></pre>
	
	<p>returns 1. This is because SQL reads 50 and 100 as integers and returns the nearest integer (i.e., 0.5 gets rounded to 1). For issues related to
	floating-point precision and numeric values, see <a href="../Programming/index.html#numeric">a description</a> of numeric variables in programming.</p>

	<p>Most applications of the <code>SELECT</code> statement will include use of a table. From a table, the statement will usually refer to fields, aggregations of fields,
	or manipulations of existing fields.</p>
	
	<pre><code>
select name, 
groupname,  
modifieddate
from adventureworks.humanresources.department
	</code></pre>	
	
<p>This query returns the table shown above. One important point about this and all queries: just as SQL does not care about case (i.e. capitalization),
it also does not care about line breaks. I have never heard of "rules" for when to break lines with SQL. Generally, however, as you become more 
comfortable with programming in T-SQL you should code in a way that promotes readability as well as consistency. The code below will work
just as well as the code above, but it's not nearly as readable:</p> 	

	<pre><code>
select 
name, groupname  
,modifieddate

from 
adventureworks.humanresources.department
	</code></pre>	
			 
			 <div align="center"><a href = "#top"><h6>Top</h6></a></div>
	
	
	<br>
	<p><b><code>SELECT *</code></b></p>
	<p>To return the complete contents of a table, you can simply use the <code>SELECT *</code> statement on a table.
	The query below also returns the table shown above because all fields were selected in the original query.</p>
	
	<pre><code>
select *
from adventureworks.humanresources.department
	</code></pre>
	
	<p>This is a mostly useful statement in practice; however, it should not be used indiscriminantly. It is generally useful
	because when you enter a server used in the real world, it is likely that there will be many, many databases and many tables.
	The process of learning what is in them (fields and types of data) requires a query in most cases. However, if you don't understand 
	the size or the structure of a table, using <code>SELECT *</code> could very well initiate a query that takes hours if the table is large enough.
	In practice, I have found the act of stopping a query (sometimes referred to casually as "killing" the query) easy enough to do in
	SQL Server Management Studio. I have found it to lock up other programs such as SQL Developer. If you ever have a query that 
	continues to run for a while (referred to casually as a query that's "spinning"), you can cancel it in SSMS by pressing the red "Stop"
	button:</p>
	
	<p>There are two options I tend to prefer if I don't know the size of the table, or if there is risk that a <code>SELECT *</code> will
	take time to complete:</p>
	
	<ul>
	<li>Use <code>SELECT TOP 10 *</code>, which will return the top 10 records. You can change the number 10 to any number
	you prefer. Also, if your query is written with logic that filters results, only the top 10 records that meet the filtering 
	criteria will be displayed. <b>Note:</b> the TOP keyword does not exist in PL/SQL.</li>
	<li>Right-click on a table in the Object Explorer, and select "Select Top 1000 Rows." A query is then self-generated. 
	The benefit of this option is that for a table with many columns, reading the fields is much easier. You can also copy/paste
	field names or the table name.</li>
	</ul>
	
	<!-- Add example pic -->
	
	<div align="center"><a href = "#top"><h6>Top</h6></a></div>
</div>







<div class="docs-section" id="from">
  <h5 class="select">2. The <code>FROM</code> clause</h5>

	<p>The <code>FROM</code> clause is such a common feature in SQL that it may as well be considered as its own statement rather
	than a "clause." But because the <code>SELECT</code> statement can stand on its own,
	anything that provides specificity to the <code>SELECT</code> statement is considered a clause.</p>
	
	<p>The <code>FROM</code> clause simply points to a table or a view. We've already seen it used before. There is a specific syntax
	to table/view names. If you're familiar with the . in VBA, you'll recognize the way a table is referred to. In VBA, the period
	allows you to navigate down a hierarchy. So, you start with the highest level first, then the next highest, and so on. For a table or 
	a view (and also a function), the full qualification is:</p>
	
	<pre><code>
[server name].[database name].[schema name].[table/view name]
	</code></pre>	
	
	<p>Since I used brackets, I may as well explain them here. SSMS allows the use of special characters and keywords in naming
	fields, tables, etc. In all programming languages I know of, a space " " is not permitted in variable naming conventions.
	It is a special character, and all programs have rules to handle special characters. 
	Typically programmers (myself included) are used to this and avoid spaces altogether. 
	But, you don't have to in T-SQL. Brackets are designed to tell the program to interpret the character only as a character.
	This is called "escaping" a special character. In the example above, the forward slash, "/", is also a special
	character.
	</p>
	
	<p>
	For keywords, T-SQL also allows you to use them as names so long as they're enclosed in brackets. For example, you can name a field
	"year" even though it is also a function that will return the year of a date. The rule is: if you use a 
	special character or a keyword, you must use brackets. If you don't, you don't <i>have to</i> use brackets.
	By default, a query generated by SSMS will use brackets for everything. I tend to view these as a hindrance and only 
	use them when necessary.
	</p>
	
	<br>
	<pre><code>
[server name].[database name].[schema name].[table/view name]
	</code></pre>	

	<p>and</p>

	<pre><code>
server_name.database_name.schema_name.table_view_name
	</code></pre>	

	<p>and</p>

	<pre><code>
server_name.[database_name].schema_name.[table/view name]
	</code></pre>	
	
	<p>are all acceptable.</p>
	<br>
	
	<p>
	The server stores databases, and databases store tables/views assigned to a schema. Schema can be used for a number of
	reasons, and it's mostly an organizational/grouping framework. Some companies may assign a group its own schema within a 
	database, which becomes more relevant and even necessary if the group is creating their own tables or curating their own
	data. The default schema within SSMS is <code>dbo</code>.
	</p>

	<!-- Add example pic and finish statement below-->	
	
	<p>
	Servers can have more schemas. In the example below, ... are also schemas within the ... database. 
	</p>
	
	<p>
	Deciding when and when you do not have to use all pieces of the table name shown above can be a bit tricky to
	first-time SSMS users. You can only remove elements from the fully qualified table name above starting with the server
	and working toward the table/view. For example, you cannot specify the database name and simultaneously omit the
	schema name. The following rules will help on when you can drop elements of the fully qualified table name:
	</p>
	
	<ol>
	<li>You only need to refer to the server name if you are querying a server other than the one your query script is connected to.</li>
	
		<!-- Add example pic -->
		
		
	<li>If you don't have to refer to the server name, you only need to refer to the database name if 
	you are querying a database other than the one your query script is connected to.</li>

	<li>If you don't have to refer to the server name and the database name, 
	you only need to refer to a schema name if the schema is not <code>dbo</code>.</li>

	</ol>
	
	<p>I tend to use the <code>[database name].[schema name].[table/view name]</code> qualification so that I can work within
	a server without having to change my connection in the query script. I only refer to the server name when necessary.</p>

	<div align="center"><a href = "#top"><h6>Top</h6></a></div>
</div>


	

	<div class="docs-section" align="center">
	<div align="center"><a href="https://github.com/MRRisley/SQL"><img src="../MRRisley/images/github_mark.png" alt="Github Icon with Link"></a></div>
	<a href="../MRRisley/index.html"><h5>Back to SQL Home</h5></a>
	</div>

</div>
</body>

</html> 
